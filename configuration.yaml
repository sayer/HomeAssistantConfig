# Loads default set of integrations. Do not remove.
default_config:

logger:

# Load frontend themes from the themes folder
frontend:
  themes: !include_dir_merge_named themes

# Text to speech
tts:
  - platform: google_translate

automation: !include automations.yaml
script: !include scripts.yaml
scene: !include scenes.yaml
shell_command: !include shell_commands.yaml

homeassistant:
  customize:
    zone.foretravel:
      radius: 20

influxdb:
  host: a0d7b954-influxdb
  port: 8086
  database: homeassistant
  username: homeassistant
  password: homeassistant
  max_retries: 3
  default_measurement: state

device_tracker:
  - platform: bluetooth_le_tracker
    track_new_devices: true
    track_battery: true

history:

recorder:
  purge_keep_days: 365

input_number:
  previous_fresh_water_gallons:
    name: Previous Fresh Water Level (Gallons)
    min: 0
    max: 135  # Tank capacity
    step: 0.1
  previous_fresh_water_time:
    name: Previous Fresh Water Time
    min: 0
    max: 9999999999  # Unix timestamp range
    step: 1
  previous_rate:
    name: Previous Smoothed Rate (GPM)
    min: -999
    max: 999
    step: 0.1
  model_year:
    name: Coach Model Year
    min: 2000
    max: 2040
    step: 1
    mode: box
    initial: 2024 
    icon: mdi:rv-truck
  coach_number:
    name: Coach Number
    min: 6000
    max: 10000
    step: 1
    mode: box
    initial: 6629 
    icon: mdi:rv-truck

input_text:
  owner_name:
    name: Owner Name
        

template:
  - sensor:
      - name: "Fresh Water Raw Rate"
        unit_of_measurement: "gallons/min"
        state: >
          {% set current_value = states('sensor.fresh_water') | float %}
          {% set current_time = as_timestamp(now()) %}
          {% set previous_value = states('input_number.previous_fresh_water_gallons') | float %}
          {% set previous_time = states('input_number.previous_fresh_water_time') | float %}

          {% if previous_time > 0 and current_time > previous_time %}
            {{ (previous_value - current_value) / ((current_time - previous_time) / 60) }}
          {% else %}
            0
          {% endif %}
        availability: >
          {{ states('sensor.fresh_water') | float >= 0 and
             states('input_number.previous_fresh_water_gallons') | float >= 0 and
             states('input_number.previous_fresh_water_time') | float > 0 }}

      - name: "Fresh Water Smoothed Rate"
        unit_of_measurement: "gallons/min"
        state: >
          {% set raw_rate = states('sensor.fresh_water_raw_rate') | float %}
          {% set previous_rate = states('input_number.previous_rate') | float %}
          {% set alpha = 0.2 %}  # Smoothing factor

          {% if previous_rate > 0 %}
            {{ (alpha * raw_rate) + ((1 - alpha) * previous_rate) }}
          {% else %}
            {{ raw_rate }}
          {% endif %}

sensor:

  - platform: rest
    name: Current ISP
    scan_interval: 600
    resource: http://ip-api.com/json/?fields=isp
    value_template: '{{ value_json.isp }}'

  - platform: rest
    name: "Outback 1"
    resource: "http://192.168.100.231/Dev_status.cgi?&Port=0"
    headers:
      Content-Type: application/json
    method: GET
    scan_interval: 30
    json_attributes_path: "devstatus.ports[0]"
    json_attributes:
      - Batt_V 
      - Warn
      - Error
      - AC_mode
      - INV_mode
      - VAC1_in_L2
      - VAC_out_L2
    value_template: "{{ value_json.devstatus.Sys_Batt_V }}"
      
  - platform: template
    sensors:
      outback1_voltage:
        friendly_name: "Outback 1 Battery Voltage"
        unit_of_measurement: "Vdc"
        value_template: "{{ state_attr('sensor.Outback_1', 'Batt_V') }}"
      outback1_warning:
        friendly_name: "Outback 1 Warning"
        value_template: "{{ state_attr('sensor.Outback_1', 'Warn') | string }}"
      outback1_error:
        friendly_name: "Outback 1 Error"
        value_template: "{{ state_attr('sensor.Outback_1', 'Error') | string }}"
      outback1_ac_mode:
        friendly_name: "Outback 1 AC Mode"
        value_template: "{{ state_attr('sensor.Outback_1', 'AC_mode') | string }}"
      outback1_inverter_mode:
        friendly_name: "Outback 1 Inverter Mode"
        value_template: "{{ state_attr('sensor.Outback_1', 'INV_mode') | string }}"
      outback1_vac1_in_l2:
        friendly_name: "Outback 1 VAC1_in_L2"
        value_template: "{{ state_attr('sensor.Outback_1', 'VAC1_in_L2') }}"
      outback1_vac_out_l2:
        friendly_name: "Outback 1 VAC_out_L2"
        value_template: "{{ state_attr('sensor.Outback_1', 'VAC_out_L2') }}"
        
  - platform: rest
    name: "Outback 2"
    resource: "http://192.168.100.228/Dev_status.cgi?&Port=0"
    headers:
      Content-Type: application/json
    method: GET
    scan_interval: 30
    json_attributes_path: "devstatus.ports[0]"
    json_attributes:
      - Batt_V 
      - Warn
      - Error
      - AC_mode
      - INV_mode
      - VAC1_in_L2
      - VAC_out_L2
    value_template: "{{ value_json.devstatus.Sys_Batt_V }}"
      
  - platform: template
    sensors:
      outback2_voltage:
        friendly_name: "Outback 2 Battery Voltage"
        unit_of_measurement: "Vdc"
        value_template: "{{ state_attr('sensor.Outback_2', 'Batt_V') }}"
      outback2_warning:
        friendly_name: "Outback 2 Warning"
        value_template: "{{ state_attr('sensor.Outback_2', 'Warn') | string }}"
      outback2_error:
        friendly_name: "Outback 2 Error"
        value_template: "{{ state_attr('sensor.Outback_2', 'Error') | string }}"
      outback2_ac_mode:
        friendly_name: "Outback 2 AC Mode"
        value_template: "{{ state_attr('sensor.Outback_2', 'AC_mode') | string }}"
      outback2_inverter_mode:
        friendly_name: "Outback 2 Inverter Mode"
        value_template: "{{ state_attr('sensor.Outback_2', 'INV_mode') | string }}"
      outback2_vac1_in_l2:
        friendly_name: "Outback 2 VAC1_in_L2"
        value_template: "{{ state_attr('sensor.Outback_2', 'VAC1_in_L2') }}"
      outback2_vac_out_l2:
        friendly_name: "Outback 2 VAC_out_L2"
        value_template: "{{ state_attr('sensor.Outback_2', 'VAC_out_L2') }}"
      
      

  - platform: history_stats
    type: time
    name: Generator Day Run Time
    entity_id: sensor.generator
    state: running
    start: '{{ now().replace(hour=0, minute=0, second=0, microsecond=0) }}'
    end: '{{ now() }}'

# Hvac Activiy
  - platform: template
    sensors:
      generator_activity:
        friendly_name: 'Generator Activity'
        value_template: '{{ state_attr("generator.", "attribute_xxx") }}'

  - platform: history_stats
    type: time
    name: Entry Light Duration
    entity_id: light.entry_light
    state: 'on'
    start: '{{ now().replace(hour=0, minute=0, second=0, microsecond=0) }}'
    end: '{{ now() }}'


  - platform: history_stats
    type: time
    name: Generator Oil Duration
    entity_id: sensor.generatorstatus
    state: 'running'
    start: '{{ states("input_datetime.reset_generator_on_time") | as_timestamp }}'
    end: '{{ now() }}'

  - platform: history_stats
    type: time
    name: Engine Day Run Time
    entity_id: input_boolean.engineon
    state: 'on'
    start: '{{ now().replace(hour=0, minute=0, second=0, microsecond=0) }}'
    end: '{{ now() }}'

  - platform: history_stats
    type: time
    name: Day Drive time
    entity_id: input_boolean.busparked
    state: 'off'
    start: '{{ now().replace(hour=0, minute=0, second=0, microsecond=0) }}'
    end: '{{ now() }}'


  - platform: history_stats
    type: time
    name: Trip Parked time
    entity_id: input_boolean.busparked
    state: 'on'
    start: '{{ states("input_datetime.reset_trip_on_time") | as_timestamp }}'
    end: '{{ now() }}'

  - platform: history_stats
    type: time
    name: Trip Drive time
    entity_id: input_boolean.busparked
    state: 'off'
    start: '{{ states("input_datetime.reset_trip_on_time") | as_timestamp }}'
    end: '{{ now() }}'

  - platform: history_stats
    type: time
    name: Engine Trip Run Time
    entity_id: input_boolean.engineon
    state: 'on'
    start: '{{ states("input_datetime.reset_engine_on_time") | as_timestamp }}'
    end: '{{ now() }}'

#  - platform: gpsd
#    name: gps
#    host: 10.100.254.94

#  - platform: gpsd
  - platform: template
    sensors:
      latitude:
        friendly_name: "Latitude"
        unit_of_measurement: "Degrees"
        value_template: "{{ state_attr('device_tracker.ipad_mini_2', 'latitude') }}"
        unique_id: "current_latitude"
      longitude:
        friendly_name: "longitude"
        unit_of_measurement: "Degrees"
        value_template: "{{ state_attr('device_tracker.ipad_mini_2', 'longitude') }}"
        unique_id: "current_longitude"
      vehicle_gps_speed:
        friendly_name: "speed"
        unit_of_measurement: "mph"
        value_template: "{{ state_attr('sensor.gps', 'speed') }}"
        unique_id: "current_gps_speed"
      vehicle_gps_elevation:
        friendly_name: "elevation"
        unit_of_measurement: "meters"
        value_template: "{{ state_attr('device_tracker.ipad_mini_2', 'elevation') }}"
        unique_id: "current_gps_elevation"

  - platform: template
    sensors:
      ac_source:
        friendly_name: "Power Source"
        value_template: >-
          {% set rms_current = states('sensor.power_rms_current') %}
          {% set generator_status = states('sensor.generatorstatus') %}
          {% if (rms_current == 0) or (rms_current == 'unknown') %}
          Inverter
          {% elif generator_status == 'running' %}
          Generator
          {% else %}
          Shore
          {% endif %}

      generator_current_run_time:
        friendly_name: "Run time"
        value_template: >-
          {% if (states('switch.generator') != 'on') or (states.switch.generatorstatus.last_changed == 'unknown') or (states.switch.generatorstatus.last_changed == 'unavailable') %}
          n/a
          {% else %}
          {{ relative_time(states.switch.generatorstatus.last_changed) | timestamp_custom('%-H hours and %-M minutes', false) }}
          {% endif %}

# Example configuration.yaml entry
notify:
  - name: "HA_Email_Notify"
    platform: smtp
    sender: "sayer@ayersnet.com"
    recipient: "sayer@ayersnet.com"

remote_homeassistant:
  instances:

# Full example configuration.yaml entry
mqtt:
  climate:
    - name: Living Room
      temperature_unit: "F"
      modes:
        - "off"
        - "heat"
        - "cool"
        - "fan_only"
      fan_modes:
        - "high"
        - "medium"
        - "low"
      mode_state_template: "{{ value_json['operating mode definition'] }}"
      mode_command_topic: "RVCSET/THERMOSTAT_COMMAND_1_MODE/2"
      #      mode_command_template: "{{ value if value=="off" else "on" }}"
      temperature_command_topic: "RVCSET/THERMOSTAT_COMMAND_1_TEMP/2"
      temperature_state_topic: "RVC/THERMOSTAT_COMMAND_1/2"
      temperature_state_template: "{{ value_json['setpoint temp heat F'] }}"
      fan_mode_command_topic: "RVC/THERMOSTAT_COMMAND_1_FAN/2"
      unique_id: "hvac_livingroom"
      precision: 1.0
      max_temp: 85
      min_temp: 40
      initial: 72
    - name: Kitchen
      temperature_unit: "F"
      modes:
        - "off"
        - "heat"
        - "cool"
        - "fan_only"
      fan_modes:
        - "high"
        - "medium"
        - "low"
      mode_state_template: "{{ value_json['operating mode definition'] }}"
      mode_command_topic: "RVCSET/THERMOSTAT_COMMAND_1_MODE/3"
      #      mode_command_template: "{{ value if value=="off" else "on" }}"
      temperature_command_topic: "RVCSET/THERMOSTAT_COMMAND_1_TEMP/3"
      temperature_state_topic: "RVC/THERMOSTAT_COMMAND_1/3"
      temperature_state_template: "{{ value_json['setpoint temp heat F'] }}"
      fan_mode_command_topic: "RVC/THERMOSTAT_COMMAND_1_FAN/3"
      unique_id: "hvac_kitchen"
      precision: 1.0
      max_temp: 85
      min_temp: 40
      initial: 72

  light:
    - name: "Panel Lights"
      state_topic: "RVC/DC_DIMMER_STATUS_3/1"
      state_value_template: "{% if value_json['brightness'] == 0 %} 0 {% else %} 100 {% endif %}"
      command_topic: "RVCSET/MESSAGE/1FED9"
      payload_on: "FF7E64FFFFFF00FF"
      payload_off: "FF7E00FFFFFF00FF"
      optimistic: true
      unique_id: "panel_lights"
    - name: "Entry Light"
      icon: mdi:light-recessed
      state_topic: "RVC/DC_DIMMER_STATUS_3/1"
      state_value_template: "{% if value_json['operating status (brightness)'] == 0 %} 0 {% else %} 100 {% endif %}"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/1"
      payload_on: "100"
      payload_off: "0"
      optimistic: true
      unique_id: "dimmer_3_1"
    - name: "Cockpit Accents"
      state_topic: "RVC/DC_DIMMER_STATUS_3/2"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      optimistic: true
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/2"
      icon: mdi:light-recessed
      unique_id: "dimmer_3_2"
    - name: "Living Room Ceiling"
      state_topic: "RVC/DC_DIMMER_STATUS_3/3"
      icon: mdi:light-recessed
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/3"
      optimistic: true
      unique_id: "dimmer_3_3"
    - name: "Living Room Accents"
      state_topic: "RVC/DC_DIMMER_STATUS_3/4"
      icon: mdi:light-recessed
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/4"
      optimistic: true
      unique_id: "dimmer_3_4"
    - name: "D/S Front Sofa"
      state_topic: "RVC/DC_DIMMER_STATUS_3/5"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/5"
      optimistic: true
      icon: mdi:light-recessed
      unique_id: "dimmer_3_5"
    - name: "D/S Front Accent"
      state_topic: "RVC/DC_DIMMER_STATUS_3/6"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/6"
      optimistic: true
      icon: mdi:light-recessed
      unique_id: "dimmer_3_6"
    - name: "Living Room Ceiling Recess"
      state_topic: "RVC/DC_DIMMER_STATUS_3/8"
      icon: mdi:light-recessed
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/8"
      optimistic: true
      unique_id: "dimmer_3_8"
    - name: "P/S Dinette Ceiling"
      state_topic: "RVC/DC_DIMMER_STATUS_3/9"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/9"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_9"
    - name: "P/S Dinette Accent"
      state_topic: "RVC/DC_DIMMER_STATUS_3/10"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/10"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_10"
    - name: "Kitchen Ceiling"
      state_topic: "RVC/DC_DIMMER_STATUS_3/12"
      icon: mdi:light-recessed
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/12"
      optimistic: true
      unique_id: "dimmer_3_12"
    - name: "Kitchen Sink"
      state_topic: "RVC/DC_DIMMER_STATUS_3/13"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/13"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_13"
    - name: "Floor Lights"
      state_topic: "RVC/DC_DIMMER_STATUS_3/14"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/14"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_14"
    - name: "Mid Batch Ceiling"
      state_topic: "RVC/DC_DIMMER_STATUS_3/15"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/15"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_15"
    - name: "Mid Batch Accent"
      state_topic: "RVC/DC_DIMMER_STATUS_3/16"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/16"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_16"
    - name: "Hall Ceiling"
      state_topic: "RVC/DC_DIMMER_STATUS_3/17"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/17"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_17"
    - name: "Bedroom Ceiling"
      state_topic: "RVC/DC_DIMMER_STATUS_3/18"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/18"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_18"
    - name: "Bedroom Ceiling Accent"
      state_topic: "RVC/DC_DIMMER_STATUS_3/19"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/19"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_19"
    - name: "Bedroom right reading"
      state_topic: "RVC/DC_DIMMER_STATUS_3/21"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/21"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_21"
    - name: "Bedroom left reading"
      state_topic: "RVC/DC_DIMMER_STATUS_3/22"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/22"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_22"
    - name: "Bedroom D/S accent"
      state_topic: "RVC/DC_DIMMER_STATUS_3/23"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/23"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_23"
    - name: "Bedroom Dresser Ceiling"
      state_topic: "RVC/DC_DIMMER_STATUS_3/24"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/24"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_24"
    - name: "Bedroom Dresser accent"
      state_topic: "RVC/DC_DIMMER_STATUS_3/25"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/25"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_25"
    - name: "Rear Bath Shower"
      state_topic: "RVC/DC_DIMMER_STATUS_3/27"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/27"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_27"
    - name: "Rear Bath Ceiling"
      state_topic: "RVC/DC_DIMMER_STATUS_3/28"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/28"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_28"
    - name: "Rear Bath Accent"
      state_topic: "RVC/DC_DIMMER_STATUS_3/29"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/29"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_29"
    - name: "Rear Bath Vanity"
      state_topic: "RVC/DC_DIMMER_STATUS_3/30"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/30"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_30"
    - name: "Bedroom Recess Ceiling"
      state_topic: "RVC/DC_DIMMER_STATUS_3/31"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/31"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_31"
    - name: "Top Bunk Reading"
      state_topic: "RVC/DC_DIMMER_STATUS_3/32"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/32"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_32"
    - name: "Top Bunk Accent"
      state_topic: "RVC/DC_DIMMER_STATUS_3/33"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/33"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_33"
    - name: "Bottom Bunk Reading"
      state_topic: "RVC/DC_DIMMER_STATUS_3/34"
      icon: mdi:light-recessed
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/34"
      optimistic: true
      unique_id: "dimmer_3_34"
    - name: "Bottom Bunk Accent"
      state_topic: "RVC/DC_DIMMER_STATUS_3/35"
      icon: mdi:light-recessed
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/35"
      optimistic: true
      unique_id: "dimmer_3_35"
    - name: "Docking Lights"
      state_topic: "RVC/DC_DIMMER_STATUS_3/121"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/121"
      optimistic: true
      unique_id: "dimmer_3_121"
    - name: "Awning Lights"
      state_topic: "RVC/DC_DIMMER_STATUS_3/122"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/122"
      optimistic: true
      unique_id: "dimmer_3_122"
    - name: "Exterior Accents"
      state_topic: "RVC/DC_DIMMER_STATUS_3/123"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/123"
      optimistic: true
      unique_id: "dimmer_3_123"
    - name: "Passenger Map Light"
      state_topic: "RVC/DC_DIMMER_STATUS_3/124"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/124"
      icon: mdi:light-recessed
      optimistic: true
      unique_id: "dimmer_3_124"
    - name: "Porch Handle"
      state_topic: "RVC/DC_DIMMER_STATUS_3/127"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/127"
      optimistic: true
      unique_id: "dimmer_3_127"
    - name: "Master Switch"
      state_topic: "RVC/DC_DIMMER_STATUS_3/128"
      state_value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/128-DONOTUSE"
      optimistic: true
      unique_id: "dimmer_3_128"

  switch:
    - name: "AC 1"
      state_topic: "RVC/THERMOSTAT_COMMAND_1/1"
      value_template: "{{ value_json['operating mode definition'] }}"
      payload_on: "01C1FFFFFFFFFFFF"
      payload_off: "01F0FFFFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEF9"
      state_on: "cool"
      state_off: "off"
      unique_id: "AC1"

    - name: "AC 2"
      state_topic: "RVC/THERMOSTAT_COMMAND_1/2"
      value_template: "{{ value_json['operating mode definition'] }}"
      payload_on: "02C1FFFFFFFFFFFF"
      payload_off: "02C0FFFFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEF9"
      state_on: "cool"
      state_off: "off"
      unique_id: "AC2"

    - name: "AC 3"
      state_topic: "RVC/THERMOSTAT_COMMAND_1/3"
      value_template: "{{ value_json['operating mode definition'] }}"
      payload_on: "03C1FFFFFFFFFFFF"
      payload_off: "03C0FFFFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEF9"
      state_on: "cool"
      state_off: "off"
      unique_id: "AC3"

    - name: "AC 4"
      state_topic: "RVC/THERMOSTAT_COMMAND_1/4"
      value_template: "{{ value_json['operating mode definition'] }}"
      payload_on: "04C1FFFFFFFFFFFF" # 04FFFFFFFF4F25FF - Set to 78
      payload_off: "04C0FFFFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEF9"
      state_on: "cool"
      state_off: "off"
      unique_id: "AC4"

    - name: "Heat 1"
      state_topic: "RVC/THERMOSTAT_COMMAND_1/1"
      value_template: "{{ value_json['operating mode definition'] }}"
      payload_on: "01F2FFFFFFFFFFFF"
      payload_off: "01F0FFFFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEF9"
      state_on: "heat"
      state_off: "off"
      unique_id: "HEAT1"

    - name: "Heat 2"
      state_topic: "RVC/THERMOSTAT_COMMAND_1/2"
      value_template: "{{ value_json['operating mode definition'] }}"
      payload_on: "02F2FFFFFFFFFFFF"
      payload_off: "02F0FFFFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEF9"
      state_on: "heat"
      state_off: "off"
      unique_id: "HEAT2"

    - name: "Heat 3"
      state_topic: "RVC/THERMOSTAT_COMMAND_1/3"
      value_template: "{{ value_json['operating mode definition'] }}"
      payload_on: "03F2FFFFFFFFFFFF"
      payload_off: "03F0FFFFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEF9"
      state_on: "heat"
      state_off: "off"
      unique_id: "HEAT3"

    - name: "Heat 4"
      state_topic: "RVC/THERMOSTAT_COMMAND_1/4"
      value_template: "{{ value_json['operating mode definition'] }}"
      payload_on: "04F2FFFFFFFFFFFF"
      payload_off: "04F0FFFFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEF9"
      state_on: "heat"
      state_off: "off"
      unique_id: "HEAT4"

    - name: "Auto Gen"
      state_topic: "RVC/AGS_CRITERION_STATUS/1"
      value_template: "{{ value_json['active status definition'] }}"
      payload_on: "01F400FFFFFFFFFF"
      payload_off: "01F000FFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEFD"
      state_on: "active"
      state_off: "inactive"
      unique_id: "auto_gen1"
    - name: "Auto Gen 5"
      state_topic: "RVC/AGS_CRITERION_STATUS/5"
      value_template: "{{ value_json['active status definition'] }}"
      payload_on: "05F4FAFFFFFFFFFF"
      payload_off: "05F0FAFFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEFD"
      state_on: "active"
      state_off: "inactive"
      unique_id: "auto_gen5"
    - name: "Auto Gen 8"
      state_topic: "RVC/AGS_CRITERION_STATUS/8"
      value_template: "{{ value_json['active status definition'] }}"
      payload_on: "08F4F8FFFFFFFFFF"
      payload_off: "08F0F8FFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEFD"
      state_on: "active"
      state_off: "inactive"
      unique_id: "auto_gen8"
    - name: "Floor Heat 1"
      state_topic: "RVC/FLOOR_HEAT_STATUS/1"
      value_template: "{{ value_json['operating status definition'] }}"
      payload_on: "01D43025FFFFFFFF"
      payload_off: "01C00000FFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEFB"
      state_on: "on"
      state_off: "off"
      unique_id: "floor_heat_1"
    - name: "Floor Heat 2"
      state_topic: "RVC/FLOOR_HEAT_STATUS/2"
      value_template: "{{ value_json['operating status definition'] }}"
      payload_on: "02D43025FFFFFFFF"
      payload_off: "02C00000FFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEFB"
      state_on: "on"
      state_off: "off"
      unique_id: "floor_heat_2"
    - name: "Floor Heat 3"
      state_topic: "RVC/FLOOR_HEAT_STATUS/3"
      value_template: "{{ value_json['operating status definition'] }}"
      payload_on: "03D48025FFFFFFFF"
      payload_off: "03C00000FFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEFB"
      state_on: "on"
      state_off: "off"
      unique_id: "floor_heat_3"
    - name: "Mid Bath Fan"
      state_topic: "RVC/DC_DIMMER_STATUS_3/55"
      value_template: "{{ value_json['operating status (brightness)'] }}"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/55"
      payload_on: "100"
      payload_off: "0"
      state_on: "100"
      state_off: "0"
      unique_id: "dimmer_3_55"
    - name: "Rear Bath Fan"
      state_topic: "RVC/DC_DIMMER_STATUS_3/56"
      value_template: "{{ value_json['operating status (brightness)'] }}"
      payload_on: "100"
      payload_off: "0"
      command_topic: "RVCSET/DC_DIMMER_STATUS_3/56"
      state_on: "100"
      state_off: "0"
      unique_id: "dimmer_3_56"
    - name: "Water Pump"
      state_topic: "RVC/WATER_PUMP_STATUS"
      value_template: "{{ value_json['operating status definition'] }}"
      payload_on: "FDFFFFFFFFFFFFFF"
      payload_off: "FCFFFFFFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FFB2"
      state_on: "on"
      state_off: "off"
      unique_id: "waterpump"
    - name: "Black Waste Dump"
      state_topic: "RVC/WASTEDUMP_COMMAND"
      value_template: "{{ value_json['black valve definition'] }}"
      payload_on: "05FFFFFFFFFFFFFF"
      payload_off: "00FFFFFFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FFAE"
      state_on: "open"
      state_off: "closed"
      unique_id: "blackwastedump"
    - name: "Gray Water Bypass"
      state_topic: "RVC/WASTEDUMP_COMMAND"
      value_template: "{{ value_json['gray valve definition'] }}"
      payload_on: "FF01FFFFFFFFFFFF"
      payload_off: "FF00FFFFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FFAE"
      state_on: "open"
      state_off: "closed"
      unique_id: "graywaterbypass"
    - name: "Water Autofill"
      state_topic: "RVC/AUTOFILL_STATUS"
      value_template: "{{ value_json['valve status definition'] }}"
      payload_on: "FDFFFFFFFFFFFFFF"
      payload_off: "FCFFFFFFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FFB0"
      state_on: "open"
      state_off: "closed"
      unique_id: "waterautofill"
    - name: "Generator"
      state_topic: "RVC/GENERATOR_STATUS_1"
      value_template: "{{ value_json['status definition'] }}"
      payload_on: "0100FFFFFFFFFFFF"
      payload_off: "000000FFFFFFFFFF"
      command_topic: "RVCSET/MESSAGE/1FEFF"
      state_on: "running"
      state_off: "stopped"
      unique_id: "generatorstatus"

  cover:
    - name: "Windshield Day"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/1"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/1"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
          {% if last_cmd == 'toggle forward' %}opening
          {% elif last_cmd == 'toggle reverse' %}closing
          {% else %}closed{% endif %}
        {% else %}
          {% if last_cmd == 'toggle forward' %}open
          {% elif last_cmd == 'toggle reverse' %}closed
          {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "01FFC8851E00FFFF"
      payload_close: "01FFC8451E00FFFF"
      payload_stop: "01FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
        100
        {% elif last_cmd == 'toggle reverse' %}
        0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "01FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
        online
        {% else %}
        offline
        {% endif %}
      unique_id: "windshield_day"
      optimistic: false

    - name: "Windshield Night"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/5"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/5"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "05FFC8851E00FFFF"
      payload_close: "05FFC8451E00FFFF"
      payload_stop: "05FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "05FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "windshield_night"
      optimistic: false
      
    - name: "Dinette Day"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/10"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/10"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "0AFFC8851E00FFFF"
      payload_close: "0AFFC8451E00FFFF"
      payload_stop: "0AFFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "0AFFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "dinette_day"
      optimistic: false
      
    - name: "Dinette Night"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/14"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/14"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "0EFFC8851E00FFFF"
      payload_close: "0EFFC8451E00FFFF"
      payload_stop: "0EFFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "0EFFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "dinette_night"
      optimistic: false

    - name: "Driver Day"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/2"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/2"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "02FFC8851E00FFFF"
      payload_close: "02FFC8451E00FFFF"
      payload_stop: "02FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "02FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "driver_day"
      optimistic: false

    - name: "Passenger Day"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/3"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/3"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "03FFC8851E00FFFF"
      payload_close: "03FFC8451E00FFFF"
      payload_stop: "03FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "03FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "passenger_day"
      optimistic: false

    - name: "Entry Door Day"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/4"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/4"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "04FFC8851E00FFFF"
      payload_close: "04FFC8451E00FFFF"
      payload_stop: "04FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "04FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "entry_door_day"
      optimistic: false

    - name: "Driver Night"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/6"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/6"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "06FFC8851E00FFFF"
      payload_close: "06FFC8451E00FFFF"
      payload_stop: "06FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "06FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "driver_night"
      optimistic: false

    - name: "Passenger Night"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/7"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/7"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "07FFC8851E00FFFF"
      payload_close: "07FFC8451E00FFFF"
      payload_stop: "07FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "07FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "passenger_night"
      optimistic: false

    - name: "Entry Door Night"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/8"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/8"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "08FFC8851E00FFFF"
      payload_close: "08FFC8451E00FFFF"
      payload_stop: "08FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "08FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "entry_door_night"
      optimistic: false

    - name: "Mid Bath Night"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/12"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/12"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "0CFFC8851E00FFFF"
      payload_close: "0CFFC8451E00FFFF"
      payload_stop: "0CFFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "0CFFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "mid_bath_night"
      optimistic: false
    
    - name: "Rear Bath Night"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/16"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/16"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "10FFC8851E00FFFF"
      payload_close: "10FFC8451E00FFFF"
      payload_stop: "10FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "10FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "rear_bath_night"
      optimistic: false

    - name: "Top Bunk Night"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/17"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/17"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "11FFC8851E00FFFF"
      payload_close: "11FFC8451E00FFFF"
      payload_stop: "11FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "11FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "top_bunk_night"
      optimistic: false

    - name: "D/S Living Room Day"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/18"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/18"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "12FFC8851E00FFFF"
      payload_close: "12FFC8451E00FFFF"
      payload_stop: "12FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "12FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "ds_living_day"
      optimistic: false

    - name: "Bedroom Dresser Day"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/20"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/20"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "14FFC8851E00FFFF"
      payload_close: "14FFC8451E00FFFF"
      payload_stop: "14FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "14FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "bedroom_dreser_day"
      optimistic: false

    - name: "Bottom Bunk Night"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/21"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/21"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "15FFC8851E00FFFF"
      payload_close: "15FFC8451E00FFFF"
      payload_stop: "15FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "15FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "bottom_bunk_night"
      optimistic: false

    - name: "D/S Living Room Night"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/22"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/22"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "16FFC8851E00FFFF"
      payload_close: "16FFC8451E00FFFF"
      payload_stop: "16FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "16FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "ds_living_night"
      optimistic: false

    - name: "Bedroom Dresser Night"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/24"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/24"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "18FFC8851E00FFFF"
      payload_close: "18FFC8451E00FFFF"
      payload_stop: "18FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "18FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "bedroom_dresser_night"
      optimistic: false

    - name: "Bedroom Front Day"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/25"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/25"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "19FFC8851E00FFFF"
      payload_close: "19FFC8451E00FFFF"
      payload_stop: "19FFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "19FFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "bedroom_front_day"
      optimistic: false

    - name: "Bedroom Rear Day"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/27"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/27"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "1BFFC8851E00FFFF"
      payload_close: "1BFFC8451E00FFFF"
      payload_stop: "1BFFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "1BFFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "bedroom_rear_day"
      optimistic: false

    - name: "Bedroom Front Night"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/29"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/29"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "1DFFC8851E00FFFF"
      payload_close: "1DFFC8451E00FFFF"
      payload_stop: "1DFFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "1DFFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "bedroom_front_night"
      optimistic: false

    - name: "Bedroom Rear Night"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/31"
      position_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/31"
      value_template: >-
        {% if not value_json is defined %}closed
        {% else %}
        {% set motor = value_json['motor status definition'] | default('inactive') %}
        {% set last_cmd = value_json['last command definition'] | default('none') %}
        {% if motor == 'active' %}
        {% if last_cmd == 'toggle forward' %}opening
        {% elif last_cmd == 'toggle reverse' %}closing
        {% else %}closed{% endif %}
        {% else %}
        {% if last_cmd == 'toggle forward' %}open
        {% elif last_cmd == 'toggle reverse' %}closed
        {% else %}closed{% endif %}
        {% endif %}
        {% endif %}
      command_topic: "RVCSET/MESSAGE/1FEDF"
      payload_open: "1FFFC8851E00FFFF"
      payload_close: "1FFFC8451E00FFFF"
      payload_stop: "1FFFC8851E0100"
      payload_available: "online"
      payload_not_available: "offline"
      state_opening: "opening"
      state_closing: "closing"
      state_open: "open"
      state_closed: "closed"
      position_template: >-
        {% set last_cmd = value_json['last command definition'] %}
        {% if last_cmd == 'toggle forward' %}
         100
        {% elif last_cmd == 'toggle reverse' %}
         0
        {% else %}
        {{ value_json.position | default(value_json['motor duty']) | default(0) }}
        {% endif %}
      position_open: 100
      position_closed: 0
      set_position_topic: "RVCSET/MESSAGE/1FEDF"
      set_position_template: "1FFFC8851E0103{{ '%02X' | format((position / 100 * 255) | round | int) }}"
      availability_template: >-
        {% if value_json is defined and value_json['motor status definition'] is defined %}
         online
        {% else %}
         offline
        {% endif %}
      unique_id: "bedroom_rear_night"
      optimistic: false

      # Example configuration.yaml entry
  lock:
    - name: "Entry Door Lock"
      icon: mdi:key
      state_topic: "RVC/LOCK_STATUS/1"
      unique_id: "EntryDoorLock"
      value_template: "{{ value_json['lock status definition'] }}"
      command_topic: "RVCSET/MESSAGE/1FEE4"
      payload_lock: "0101FFFFFFFFFFFF"
      payload_unlock: "0100FFFFFFFFFFFF"
      state_locked: "locked"
      state_unlocked: "unlocked"
    - name: "Cargo Door D/S"
      icon: mdi:key
      state_topic: "RVC/LOCK_STATUS/2"
      value_template: "{{ value_json['lock status definition'] }}"
      command_topic: "RVCSET/MESSAGE/1FEE4"
      payload_lock: "0201FFFFFFFFFFFF"
      payload_unlock: "0200FFFFFFFFFFFF"
      state_locked: "locked"
      state_unlocked: "unlocked"
      unique_id: "cargolock2"
    - name: "Cargo Door P/S"
      icon: mdi:key
      state_topic: "RVC/LOCK_STATUS/3"
      value_template: "{{ value_json['lock status definition'] }}"
      command_topic: "RVCSET/MESSAGE/1FEE4"
      payload_lock: "0301FFFFFFFFFFFF"
      payload_unlock: "0300FFFFFFFFFFFF"
      state_locked: "locked"
      state_unlocked: "unlocked"
      unique_id: "cargolock3"
    - name: "Cargo Door 3"
      icon: mdi:key
      state_topic: "RVC/LOCK_STATUS/4"
      value_template: "{{ value_json['lock status definition'] }}"
      command_topic: "RVCSET/MESSAGE/1FEE4"
      payload_lock: "0401FFFFFFFFFFFF"
      payload_unlock: "0400FFFFFFFFFFFF"
      state_locked: "locked"
      state_unlocked: "unlocked"
      unique_id: "cargolock4"
    - name: "Cargo Door 4"
      icon: mdi:key
      state_topic: "RVC/LOCK_STATUS/6"
      value_template: "{{ value_json['lock status definition'] }}"
      command_topic: "RVCSET/MESSAGE/1FEE4"
      payload_lock: "0601FFFFFFFFFFFF"
      payload_unlock: "0601FFFFFFFFFFFF"
      state_locked: "locked"
      state_unlocked: "unlocked"
      unique_id: "cargolock5"

  sensor:
    - name: "Shade Raw Data"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/1"
      value_template: "{{ value_json }}"
    
    - name: "Shade Status Monitor"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/1"
      value_template: >-
        Motor: {{ value_json['motor status definition'] }},
        Forward: {{ value_json['forward status definition'] }},
        Reverse: {{ value_json['reverse status definition'] }}

    - name: "Shade Position Monitor"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/1"
      value_template: >-
        Position: {{ value_json.position | default(0) }},
        Motor Duty: {{ value_json['motor duty'] }}

    - name: "Shade Full State"
      state_topic: "RVC/WINDOW_SHADE_CONTROL_STATUS/1"
      value_template: >-
        Pos: {{ value_json.position | default(value_json['motor duty']) | default(0) }},
        LastCmd: {{ value_json['last command definition'] }},
        Motor: {{ value_json['motor status definition'] }},
        Forward: {{ value_json['forward status definition'] }},
        Reverse: {{ value_json['reverse status definition'] }}
        State: 
        {% if value_json['motor status definition'] == 'active' %}
        {% if value_json['last command definition'] == 'toggle forward' %}opening
        {% elif value_json['last command definition'] == 'toggle reverse' %}closing
        {% else %}unknown{% endif %}
        {% else %}
        {% if value_json['last command definition'] == 'toggle forward' %}open
        {% elif value_json['last command definition'] == 'toggle reverse' %}closed
        {% else %}unknown{% endif %}
        {% endif %}

    - name: "DC House Voltage"
      state_topic: "RVC/DC_SOURCE_STATUS_1/1"
      unique_id: "DCHouseVoltage"
      unit_of_measurement: "V"
      device_class: voltage
      state_class: measurement
      icon: mdi:car-battery
      value_template: "{{ value_json['dc voltage'] }}"
    - name: "Inverter"
      state_topic: "RVC/INVERTER_STATUS/1"
      unique_id: "INVERTER_STATUS"
      value_template: "{{ value_json['status definition'] }}"
    - name: "Charger Current"
      state_topic: "RVC/CHARGER_STATUS/1"
      unique_id: "CHARGER_STATUS_CURRENT"
      unit_of_measurement: "V"
      device_class: voltage
      state_class: measurement
      icon: mdi:car-battery
      value_template: "{{ value_json['charge current'] }}"
    - name: "Charger Voltage"
      state_topic: "RVC/CHARGER_STATUS/1"
      unique_id: "CHARGER_STATUS_VOLTAGE"
      icon: mdi:car-battery
      unit_of_measurement: "V"
      device_class: voltage
      state_class: measurement
      value_template: "{{ value_json['charge voltage'] }}"
    - name: "Ambient Temperature"
      state_topic: "RVC/THERMOSTAT_AMBIENT_STATUS/249"
      unique_id: "THERMOSTAT_AMBIENT_STATUS"
      unit_of_measurement: "F"
      state_class: measurement
      value_template: "{{ value_json['ambient temp F'] }}"
    - name: "Inside Temperature"
      state_topic: "RVC/THERMOSTAT_AMBIENT_STATUS/250"
      unique_id: "THERMOSTAT_INDOOR_TEMP"
      unit_of_measurement: "F"
      state_class: measurement
      value_template: "{{ value_json['ambient temp F'] }}"
    - name: "Parking Brake"
      state_topic: "RVC/CHASSIS_MOBILITY_STATUS"
      unique_id: "ParkingBrake"
      #state_class: measurement
      device_class: enum
      value_template: "{{ value_json['park brake status definition'] }}"
    - name: "Vehicle Speed"
      state_topic: "RVC/CHASSIS_MOBILITY_STATUS"
      unique_id: "vehiclespeed"
      icon: mdi:speedometer
      state_class: measurement
      value_template: "{{ ((value_json['vehicle speed'] | float / 256) / 1.609344) | round(0) | int }}"
    - name: "Vehicle RPM"
      state_topic: "RVC/CHASSIS_MOBILITY_STATUS"
      unique_id: "engine_rpm"
      icon: mdi:speedometer
      state_class: measurement
      value_template: >-
        {% if ((value_json['engine rpms'] == 'unknown') or (value_json['engine rpms'] == 'unavailable')) %}
          0
          {% else %}
          {{ (((value_json['engine rpms']) | float) * 0.125) | int}}
          {% endif %}

    - name: "Transmision Gear"
      state_topic: "RVC/CHASSIS_MOBILITY_STATUS"
      unique_id: "transmissiongear"
      icon: mdi:car-shift-pattern
      #state_class: measurement
      device_class: enum
      value_template: "{{ value_json['transmission current gear definition'] }}"
    - name: "Fresh Water"
      state_topic: "RVC/TANK_STATUS/0"
      unit_of_measurement: "%"
      state_class: measurement
      value_template: "{{ ((value_json['relative level'] | float) * (value_json['resolution'])) | round(0) | int }}"
      icon: mdi:car-coolant-level
      unique_id: "FreshWater"
    - name: "Generator"
      state_topic: "RVC/GENERATOR_STATUS_1"
      value_template: "{{ value_json['status definition'] }}"
      unique_id: "generatorstatus"
    - name: "Generator Hours"
      state_topic: "RVC/GENERATOR_STATUS_1"
      value_template: "{{ (value_json['engine run time'] / 60) | int }}"
      state_class: total
      unique_id: "generator_hours"
    - name: "Generator Auto Started"
      state_topic: "RVC/RVC/GENERATOR_DEMAND_STATUS"
      value_template: "{{ value_json['generator demand definition']  }}"
      unique_id: "generator_auto_started"
    - name: "Power RMS Current"
      state_topic: "RVC/ATS_AC_STATUS_1/1"
      state_class: measurement
      unit_of_measurement: "A"
      value_template: "{{ value_json['rms current'] }}" 
#      value_template: >-
#        {% if (value_json['rms current'] == 'unknown')  %}
#          0
#          {% else %}
#          {{ value_json['rms current'] }}
#          {% endif %}
      unique_id: "power_rms_current"
    - name: "Power RMS Voltage"
      state_topic: "RVC/ATS_AC_STATUS_1/1"
      value_template: "{{ value_json['rms voltage'] }}"
      device_class: voltage
      state_class: measurement
      unit_of_measurement: "V"
      unique_id: "power_rms_voltage"
    - name: "Generator RPM"
      state_topic: "RVC/GENERATOR_STATUS_2"
      value_template: "{{ (((value_json['engine rpm']) | float) * 0.125) | int}}"
      unique_id: "generator_rpm"
      state_class: measurement
    - name: "Generator Caution Light"
      state_topic: "RVC/GENERATOR_STATUS_2"
      value_template: "{{ (value_json['caution light']) }}"
      unique_id: "generator_caution_light"
      state_class: measurement
    - name: "Generator Coolent Temperature"
      state_topic: "RVC/GENERATOR_STATUS_2"
      value_template: "{{ (value_json['engine coolant temperature F']) }}"
      unique_id: "generator_coolant_temp"
      state_class: measurement
    - name: "Generator Oil Pressure"
      state_topic: "RVC/GENERATOR_STATUS_2"
      value_template: "{{ (value_json['engine oil pressure']) }}"
      unique_id: "generator_coolant_oil_pressure"
      state_class: measurement
    - name: "Generator Fuel Rate"
      state_topic: "RVC/GENERATOR_STATUS_2"
      value_template: "{{ (value_json['fuel rate']) }}"
      unique_id: "generator_fuel_rate"
      state_class: measurement
    - name: "Generator oil level shutdown alert"
      state_topic: "RVC/GENERATOR_STATUS_2"
      value_template:  >
        {% if value_json['oil level shutdown switch'] == 0 %}
          {{ "Off" | string }}
        {% else %}
          {{ "Alert" | string }}
        {% endif %}
      unique_id: "generator_oil_level_shutdown_alert"
    - name: "Generator oil pressure shutdown alert"
      state_topic: "RVC/GENERATOR_STATUS_2"
      value_template:  >
        {% if value_json['oil pressure shutdown switch'] == 0 %}
          {{ "Off" | string }}
        {% else %}
          {{ "Alert" | string }}
        {% endif %}
      unique_id: "generator_oil_pressure_shutdown_alert"
    - name: "Generator temperature shutdown alert"
      state_topic: "RVC/GENERATOR_STATUS_2"
      value_template:  >
        {% if value_json['temperature shutdown switch'] == 0 %}
          {{ "Off" | string }}
        {% else %}
          {{ "Alert" | string }}
        {% endif %}
      unique_id: "generator_temperature_shutdown_alert"

    - name: "Black Tank"
      state_topic: "RVC/TANK_STATUS/1"
      value_template: "{{ (value_json['relative level'] | float) * (value_json['resolution']) | round(0) | int }}"
      unit_of_measurement: "%"
      state_class: measurement
      icon: mdi:car-coolant-level
      unique_id: "BlackTank"
    - name: "Chassis Battery"
      state_topic: "RVC/DC_SOURCE_STATUS_1/1"
      unit_of_measurement: "V"
      #device_class: energy
      state_class: measurement
      value_template: "{{ value_json['dc voltage'] }}"
      icon: mdi:car-battery
      unique_id: "chasis_voltage"
    - name: "TV Lift Open"
      state_topic: "RVC/DC_DIMMER_STATUS_3/125"
      value_template: "{{ value_json['operating status (brightness)'] }}"
      icon: mdi:light-recessed
      unit_of_measurement: "%"
      unique_id: "dimmer_3_125"
    - name: "TV Lift Close"
      state_topic: "RVC/DC_DIMMER_STATUS_3/126"
      value_template: "{{ value_json['operating status (brightness)'] }}"
      icon: mdi:light-recessed
      unit_of_measurement: "%"
      unique_id: "dimmer_3_126"
    - name: "Battery Disconnect"
      state_topic: "RVC/DC_DIMMER_STATUS_3/128"
      value_template: "{{ value_json['operating status (brightness)'] }}"
      unit_of_measurement: "%"
      unique_id: "dimmer_3_128"

  binary_sensor:
    - name: "Water Hookup"
      state_topic: "RVC/WATER_PUMP_STATUS"
      value_template: "{{ value_json['water hookup detected definition'] }}"
      payload_on: "on"
      payload_off: "off"
      unique_id: "water_hookup"
    - name: "Water Pump Active"
      state_topic: "RVC/WATER_PUMP_STATUS"
      value_template: "{{ value_json['pump status definition'] }}"
      payload_on: "on"
      payload_off: "off"
      unique_id: "water_pump_active"
    - name: "Water Autofill Valve"
      state_topic: "RVC/AUTOFILL_STATUS"
      value_template: "{{ value_json['valve status definition'] }}"
      payload_on: "open"
      payload_off: "closed"
      unique_id: "water_autofill_value"
    - name: "Water Autofill"
      state_topic: "RVC/AUTOFILL_STATUS"
      value_template: "{{ value_json['operating status definition'] }}"
      payload_on: "on"
      payload_off: "off"
      unique_id: "water_autofill"
    - name: "Black Waste Dump"
      state_topic: "RVC/WASTEDUMP_STATUS"
      value_template: "{{ value_json['black valve status definition'] }}"
      payload_on: "open"
      payload_off: "closed"
      unique_id: "blacK_waste_dump"
    - name: "Gray Water Dump"
      state_topic: "RVC/WASTEDUMP_STATUS"
      value_template: "{{ value_json['gray valve status definition'] }}"
      payload_on: "open"
      payload_off: "closed"
      unique_id: "gray_water_dump"
